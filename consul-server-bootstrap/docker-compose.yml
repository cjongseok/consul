consul_server:
    restart: always
    image: localconsul
    ports:
        - 8300:8300
        - 8301:8301
        - 8301:8301/udp
        - 8302:8302
        - 8302:8302/udp
        - 8400:8400
        - 8500:8500
        - 53:53/udp
    environment:
        - DOCKER_HOST_DC=default
        - SERVICE_NAME=consul  
#    volumes:
#        - consul.json:/etc/consul/consul.json
    command: -server -advertise 192.168.1.188 -bootstrap-expect 1 -ui-dir /ui
    #command: aws-server -bootstrap-expect 1 -ui-dir /ui

    #consul:
    #    container_name: consul
    #    image: cjongseok/consul
    #    restart: always
    #    expose: 
    #            - "8300"
    #            - "8301"
    #            - "8301/udp"
    #            - "8302"
    #            - "8302/udp"
    #            - "8400"
    #            - "8500"
    #            - "53/udp"
    #    ports:
    #        - "8300:8300"
    #        - "8301:8301"
    #        - "8301:8301/udp"
    #        - "8302:8302"
    #        - "8302:8302/udp"
    #        - "8400:8400"
    #        - "8500:8500"
    #        - "53:53/udp"
    #    volumes:
    #        - consul.json:/etc/consul/consul.json
    #    #command: aws-agent -join consul.ybrainlab.com -config-file /etc/consul/consul.json
    #    links:
    #        - consul_server:consul_server
    #    command: agent -join consul_server -config-file /etc/consul/consul.json

registrator:
    container_name: consul-registrator
    image: gliderlabs/registrator
    restart: always
    volumes:
        - "/var/run/docker.sock:/tmp/docker.sock"
    links:
        #        - consul:consul
        - consul_server:consul
    command: consul://consul:8500
